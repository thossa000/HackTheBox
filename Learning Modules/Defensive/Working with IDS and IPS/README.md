# Working with IDS/IPS
Brief notes on the HackTheBox Academy module, Working with IDS/IPS, in the SOC Analyst learning path.

## Zeek Fundamentals
### Zeek's Operation Modes
Zeek operates in the following modes:

- Fully passive traffic analysis
- libpcap interface for packet capture
- Real-time and offline (e.g., PCAP-based) analysis
- Cluster support for large-scale deployments

### Zeek's Architecture
Zeek's architecture comprises two primary components: the event engine (or core) and the script interpreter.

The event engine takes an incoming packet stream and transforms it into a series of high-level events. In Zeek's context, these events describe network activity in policy-neutral terms, meaning they inform us of what's happening, but they don't offer an interpretation or evaluation of it.

Such interpretation or analysis is provided by Zeek's script interpreter, which executes a set of event handlers written in Zeek's scripting language (Zeek scripts). These scripts express the site's security policy, defining actions to be taken upon the detection of certain events.

Events generated by Zeek's core are queued in an orderly manner, awaiting their turn to be processed on a first-come, first-served basis. Most of Zeek's events are defined in .bif files located in the /scripts/base/bif/plugins/ directory.

### Zeek Logs
Among the diverse array of logs Zeek produces, some familiar ones include:

- conn.log: This log provides details about IP, TCP, UDP, and ICMP connections.
- dns.log: Here, you'll find the details of DNS queries and responses.
- http.log: This log captures the details of HTTP requests and responses.
- ftp.log: Details of FTP requests and responses are logged here.
- smtp.log: This log covers SMTP transactions, such as sender and recipient details.

It's noteworthy to mention that Zeek, in its standard configuration, applies gzip compression to log files every hour. The older logs are then transferred into a directory named in the YYYY-MM-DD format. When dealing with these compressed logs, alternative tools like gzcat for printing logs or zgrep for searching within logs can come in handy. However, Zeek also provides a specialized tool known as zeek-cut for handling log files. This utility accepts Zeek log files via standard input using pipelines or stream redirections and then delivers the specified columns to the standard output.

